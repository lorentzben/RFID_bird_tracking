---
title: "RFID Room 2"
output:
  pdf_document: default
  html_notebook: default
  html_document:
    df_print: paged
---


# Data Preprocessing

```{r function to clean data from duplicate reads}
identify_duplicate_records <- function(records){
  records$duplicate <- rep(0, length(records$subzone))
  records <- records[order(records$accessdate),]
  
  for(i in 3:length(records$subzone)){

    primary <- records[i-2,]
    secondary <- records[i-1,]
    tertiary <- records[i,]
    #print(primary)

    #print(paste(primary$subzone," : ",secondary$subzone))
  
  
    #check if primary zone is same as secondary zone
    if(length(unique(c(primary$subzone,secondary$subzone,tertiary$subzone)))!=3){
      if(primary$subzone != secondary$subzone){
        records[[i-2,"duplicate"]] <- 1
      } else if(secondary$subzone != tertiary$subzone){
        records[[i-1,"duplicate"]] <- 1
      }
    }

  }
  return(records)
}

```

```{r from Keni's data}
# from Analyis.R generated by Keni
 getTimeBudget <- function(data,selectedIDs) {
  columns = c("tag","Standing","Walking","Rest","Feeding") 
  TBS = data.frame(matrix(nrow = 0, ncol = length(columns))) 
  colnames(TBS) = columns
  for (tagidx in 1:length(selectedIDs)) {
    i <- which(data$tag == selectedIDs[tagidx])
 
     TBStag<- data.frame(tag=data$tag[i],x = data$x[i], y = data$y[i], t = (data$t2[i] - data$t1[i]) / 1000 / 60 / 60, act=data$activity[i])
     tag<-selectedIDs[tagidx]
     TB1<-sum(TBStag[which(TBStag$act == 1),]$t)/sum(TBStag$t)
    
     TB2<-sum(TBStag[which(TBStag$act == 2),]$t)/sum(TBStag$t)
     
     TB3<-sum(TBStag[which(TBStag$act == 3),]$t)/sum(TBStag$t)
     
     TB4<-sum(TBStag[which(TBStag$act == 4),]$t)/sum(TBStag$t)
     TBS[tagidx,]<-c(tag,TB1,TB2,TB3,TB4)
     
  }
 
  return(TBS)
  
}
```

```{r nice start function}

nice_start <- function(dataframe, units, interval_min){
  requireNamespace("lubridate")
  dataframe[1,1]$datetime <- round_date(ymd_hms(dataframe[1,1]$datetime), unit=units)
  attr(dataframe, 'interval') <- new_interval(min=interval_min)
  # remove duplicate entries 
  #dataframe <- dataframe[!duplicates(dataframe)]

  return(dataframe)
}

```

## Import Room 2

```{r generate transition tables for room 2}

library(xts)
library(lubridate)
library(tidyverse)
library(tidyr)
library(dplyr)
library(tsibble)


room_2 <- read.csv("../data/DK20-03-RFID-R2-febmay-080423.csv")

bird_ids_room_2 <- unique(room_2$tagname)
bird_ids_room_2 <- na.trim(sort(bird_ids_room_2))

room_2["DateTime"] <- as.POSIXct(room_2$access, origin="1970-01-01", tz="GMT")

print("what makes up subzone col")
unique(room_2$subzone)

room_2$subzone[room_2$subzone == "Bottom"] <- "bottom"
room_2$subzone[room_2$subzone == "Middle"] <- "middle"
room_2$subzone[room_2$subzone == "Top"] <- "top"

#65475
print("what makes up subzone col")
unique(room_2$subzone)

print("how many NAs in DateTime and Subzone")
sum(is.na(room_2$DateTime))
sum(is.na(room_2$subzone))

room_2$accessdate <- dmy_hms(room_2$accessdate)

# find the five number summary to determine the median interval in seconds of each reading to determine the proper sampling interval
# mean of the median times for room 2 is 9 minutes so move up to 10 minutes
# mean of the mean times for room 2 is 38 minutes so move down to every 30 minutes
room_2_summary <- room_2 |> nest(data = - tagname) |> 
 na.exclude() |>
 mutate(id_dupes = map(data ,~identify_duplicate_records(.x))) |>
 mutate(cleaned = map(id_dupes, ~.x[! .x$duplicate == 1,])) |>
 mutate(tsibble = map(cleaned, ~tsibble(datetime = ymd_hms(.x$accessdate), value = .x$subzone, index = datetime) )) |>
 mutate(intervals_s = map(tsibble, ~ as.numeric(difftime(.x$datetime[1:(length(.x$datetime)-1)], .x$datetime[2:length(.x$datetime)],units='secs') ))) |>
 mutate(summary = map(intervals_s, ~summary(.x))) |>
 mutate(minimum = map(summary, ~abs(.x[6]))) |>
 mutate(median = map(summary, ~.x[3])) |>
 mutate(mean = map(summary, ~.x[4])) |>
 unnest(c(minimum, median,mean))

# Time in minutes of average duration between transitions
(mean(room_2_summary$median)/60)
(mean(room_2_summary$mean)/60)
(min(room_2_summary$minimum))

# when is a nice time to start the study?

# No Room 3 2021-02-18 T23:30:00/2021-05-06 T23:00:00
# All Rooms 2021-03-09 T20:00:00/2021-05-06 T23:00:00

# 
room_2_struct <- room_2 |> nest(data = - tagname) |> 
 na.exclude() |>
 mutate(id_dupes = map(data ,~identify_duplicate_records(.x))) |>
 mutate(cleaned = map(id_dupes, ~.x[! .x$duplicate == 1,])) |>
 mutate(tsibble = map(cleaned, ~tsibble(datetime = ymd_hms(.x$accessdate), value = .x$subzone, index = datetime) ))
 
attr(room_2_struct$tsibble, 'interval') <- new_interval(minute = 10)
#TODO need to set the start time for each series to a nice time


# round the first entry to the nearest 10 minute interval to provide a nice sampling interval, then interpolate the rest of the intervals
room_2_regular <- room_2_struct |>
 mutate(near_5 = map(tsibble, ~ nice_start(.x, "5 seconds",5/60))) |>
 mutate(perSec = map(near_5, ~ fill_gaps(.x))) |>
 mutate(sampled = map(perSec, ~ na.locf(.x))) |>
 unnest(sampled)

# are we able to then round the table after to remove the entries off the sampling timeperiod?



room_2_struct <- room_2_struct |>
  mutate(sampled = map(perSec, ~ na.locf(.x)))

#tmp <- tsibble(datetime = ymd_hms(room_2_struct$cleaned[[1]]$accessdate), value = room_2_struct$cleaned[[1]]$subzone, index = datetime) %>% fill_gaps() %>% na.locf() %>% fill_gaps() %>% na.locf()
  
  

 


map(data, ~ .x |> 
                                 track_resample(rate = hours(4), tolerance = minutes(10)) |>
                                 steps_by_burst()))


#generate list of XTS objects 
reslist_room_2 <- list()
for(i in 1:length(bird_ids_room_2)){
  
  res <- sep_bird_id_xts(samp_name="room 2",cage_obj =room_2, samp_id = bird_ids_room_2[i])
  reslist_room_2[[i]] <- res
}

cutoff_room_2 <- data.frame()
for(i in 1:length(reslist_room_2)){
  id <- reslist_room_2[[i]]$ID
  top <- index(head(reslist_room_2[[i]]$xts_obj))[1]
  bottom <- index(tail(reslist_room_2[[i]]$xts_obj))[6]
  rec <- cbind(id,as.character(top),as.character(bottom))
  cutoff_room_2 <- rbind(cutoff_room_2,rec)
  
}

#head
cutoff_room_2[order(cutoff_room_2$V2),]
#tail
cutoff_room_2[order(cutoff_room_2$V3),]



#remove <- c("6910","6914","9005")
remove <- c("6910","6966","6914")
bird_ids_room_2_new <- bird_ids_room_2 [! bird_ids_room_2  %in% remove ]
#generate list of the first 10 truncated XTS objects
reslist2_room_2 <- list()
for(i in 1:length(bird_ids_room_2_new)){
  res <- sep_bird_id_period(samp_name="room 2",cage_obj =room_2, samp_id = bird_ids_room_2_new[i],cutoff = "2021-03-09 T20:00:00/2021-05-06 T23:00:00")
  reslist2_room_2[[i]] <- res
}

#find wholly non-na daily timeset, to be able to feed into the transcalc
big_table_room_2 <- reslist2_room_2[[1]]$daily_obj
for(i in 2:length(reslist2_room_2)){
  current <- reslist2_room_2[[i]]$daily_obj
  colnames(current) <- as.character(reslist2_room_2[[i]]$ID)
  big_table_room_2 <- cbind(big_table_room_2,current)
}
print("How many NAs in big_table_room_2")
print(sum(is.na(big_table_room_2)))
```

## Import Room 3

```{r import room 3}
library(xts)
library(tidyverse)

room_3 <- read.csv("../data/DK20-03-RFID-R3-febmay-080423.csv") %>% na.exclude()

bird_ids_room_3 <- unique(room_3$tagname)
bird_ids_room_3 <- na.trim(sort(bird_ids_room_3))

room_3["DateTime"] <- as.POSIXct(room_3$access, origin="1970-01-01", tz="GMT")

print("what makes up subzone col")
unique(room_3$subzone)

room_3$subzone[room_3$subzone == "Bottom"] <- "bottom"
room_3$subzone[room_3$subzone == "Middle"] <- "middle"
room_3$subzone[room_3$subzone == "Top"] <- "top"


print("what makes up subzone col")
unique(room_3$subzone)

print("how many NA's are in Datetime and Subzone")
sum(is.na(room_3$DateTime))
sum(is.na(room_3$subzone))

room_3 <- room_3[!is.na(room_3$DateTime),]

print("how many NA's are in Datetime and Subzone")
sum(is.na(room_3$DateTime))
sum(is.na(room_3$subzone))


#generate list of XTS objects 
reslist_room_3 <- list()
for(i in 1:length(bird_ids_room_3)){
  
  res <- sep_bird_id_xts(samp_name="room_3",cage_obj =room_3, samp_id = bird_ids_room_3[i])
  reslist_room_3[[i]] <- res
}



cutoff_room_3 <- data.frame()
for(i in 1:length(reslist_room_3)){
  id <- reslist_room_3[[i]]$ID
  top <- index(head(reslist_room_3[[i]]$xts_obj))[1]
  bottom <- index(tail(reslist_room_3[[i]]$xts_obj))[6]
  rec <- cbind(id,as.character(top),as.character(bottom))
  cutoff_room_3 <- rbind(cutoff_room_3,rec)
  
}

#head
cutoff_room_3[order(cutoff_room_3$V2),]
#tail
cutoff_room_3[order(cutoff_room_3$V3),]


#remove <- c("6998")
remove <- c("6915","9008","6912","6987","6948","6953","6879","6968","9029")
bird_ids_room_3_new <- bird_ids_room_3 [! bird_ids_room_3  %in% remove ]
#generate list of the first 10 truncated XTS objects
reslist2_room_3 <- list()
for(i in 1:length(bird_ids_room_3_new)){
  res <- sep_bird_id_period(samp_name="room 3",cage_obj=room_3, samp_id =bird_ids_room_3_new[i],cutoff = "2021-03-09 T20:00:00/2021-05-06 T23:00:00")
  #print(res)

  reslist2_room_3[[i]] <- res
}



#find wholly non-na daily timeset, to be able to feed into the transcalc
big_table_room_3 <- reslist2_room_3[[1]]$daily_obj
for(i in 2:length(reslist2_room_3)){
  current <- reslist2_room_3[[i]]$daily_obj
  big_table_room_3 <- cbind(big_table_room_3,current)
}
print("how many NA's are in big_table_room_3")
print(sum(is.na(big_table_room_3)))
```

## Import Room 8

```{r import Room 8}
library(xts)

room_8 <- read.csv("../data/DK20-03-RFID-r8-febmay-080423.csv")

bird_ids_room_8 <- na.trim(unique(room_8$tagname))
bird_ids_room_8 <- sort(bird_ids_room_8)

room_8["DateTime"] <- as.POSIXct(room_8$access, origin="1970-01-01", tz="GMT")

print("what makes up subzone col")
unique(room_8$subzone)

room_8$subzone[room_8$subzone == "Bottom"] <- "bottom"
room_8$subzone[room_8$subzone == "middle"] <- "middle"
room_8$subzone[room_8$subzone == "Top"] <- "top"
room_8 <-subset(room_8, subzone!="test")

print("what makes up subzone col")
unique(room_8$subzone)

print("how many NA's in Datetime and Subzone")
sum(is.na(room_8$DateTime))
sum(is.na(room_8$subzone))

#generate list of XTS objects 
reslist_room_8 <- list()
for(i in 1:length(bird_ids_room_8)){
  
  res <- sep_bird_id_xts(samp_name="room 8",cage_obj =room_8, samp_id = bird_ids_room_8[i])
  reslist_room_8[[i]] <- res
}

cutoff_room_8 <- data.frame()
for(i in 1:length(reslist_room_8)){
  id <- reslist_room_8[[i]]$ID
  top <- index(head(reslist_room_8[[i]]$xts_obj))[1]
  bottom <- index(tail(reslist_room_8[[i]]$xts_obj))[6]
  rec <- cbind(id,as.character(top),as.character(bottom))
  cutoff_room_8 <- rbind(cutoff_room_8,rec)
  
}

#head
cutoff_room_8[order(cutoff_room_8$V2),]
#tail
cutoff_room_8[order(cutoff_room_8$V3),]

remove <-c("6949","6936","6974","9009","9011","6995")
bird_ids_room_8_new <- bird_ids_room_8 [! bird_ids_room_8  %in% remove ]
#generate list of the first 10 truncated XTS objects
reslist2_room_8 <- list()
for(i in 1:length(bird_ids_room_8_new)){
  res <- sep_bird_id_period(samp_name="room 8",cage_obj =room_8, samp_id = bird_ids_room_8_new[i],cutoff = "2021-03-09 T20:00:00/2021-05-06 T23:00:00")
  reslist2_room_8[[i]] <- res
}

#find wholly non-na daily timeset, to be able to feed into the transcalc
big_table_room_8 <- reslist2_room_8[[1]]$daily_obj
for(i in 2:length(reslist2_room_8)){
  current <- reslist2_room_8[[i]]$daily_obj
  big_table_room_8 <- cbind(big_table_room_8,current)
}
print("how many NA's in big_table_room_8")
print(sum(is.na(big_table_room_8)))
```

## Import Room 11

```{r import Room 11}
library(xts)

room_11 <- read.csv("../data/DK20-03-RFID-R11-febmay-080423.csv")

bird_ids_room_11 <- na.trim(unique(room_11$tagname))
bird_ids_room_11 <- sort(bird_ids_room_11)

room_11 <- room_11[order(room_11$access),] 

room_11["DateTime"] <- as.POSIXct(room_11$access, origin="1970-01-01", tz="GMT")

print("what composes the subzone column")
unique(room_11$subzone)

room_11$subzone[room_11$subzone == "M"] <- "middle"
room_11$subzone[room_11$subzone == "B"] <- "bottom"
room_11$subzone[room_11$subzone == "T"] <- "top"

print("what composes the subzone column")
unique(room_11$subzone)

print("how many NA's in the DateTime col")
sum(is.na(room_11$DateTime))

room_11 <- room_11[!is.na(room_11$DateTime),]

print("how many NA's in the Datetime col")
sum(is.na(room_11$DateTime))

#generate list of XTS objects 
reslist_room_11 <- list()
for(i in 1:length(bird_ids_room_11)){
  
  res <- sep_bird_id_xts(samp_name="room 11",cage_obj =room_11, samp_id = bird_ids_room_11[i])
  reslist_room_11[[i]] <- res
}

# index 10 is an error right now, how can we fix na value

remove <- c("6888")

cutoff_room_11 <- data.frame()
for(i in 1:length(reslist_room_11)){
  print(i)
  id <- reslist_room_11[[i]]$ID
  if(id %in% remove){
  } else{
    top <- index(head(reslist_room_11[[i]]$xts_obj))[1]
    bottom <- index(tail(reslist_room_11[[i]]$xts_obj))[6]
    rec <- cbind(id,as.character(top),as.character(bottom))
    cutoff_room_11 <- rbind(cutoff_room_11,rec)
  }
}

#head
cutoff_room_11[order(cutoff_room_11$V2),]
#tail
cutoff_room_11[order(cutoff_room_11$V3),]

 

remove <- c("6888","6868","6880","6881","6893","6892", "6894","6862","6898","6882","6899","6887","6896","6889","6895","6885","6900","6897","6891","6884","6906","6920","6954","6991","6930","9059","9060")
bird_ids_room_11_new <- bird_ids_room_11 [! bird_ids_room_11  %in% remove ]
#generate list of the first 10 truncated XTS objects
reslist2_room_11 <- list()
for(i in 1:length(bird_ids_room_11_new)){
  res <- sep_bird_id_period(samp_name="room 11",cage_obj =room_11, samp_id = bird_ids_room_11_new[i], cutoff="2021-03-09 T20:00:00/2021-05-06 T23:00:00")
  reslist2_room_11[[i]] <- res
}


#find wholly non-na daily timeset, to be able to feed into the transcalc
big_table_room_11 <- reslist2_room_11[[1]]$daily_obj
for(i in 2:length(reslist2_room_11)){
  current <- reslist2_room_11[[i]]$daily_obj
  big_table_room_11 <- cbind(big_table_room_11,current)
}
print("Na's in big_table_room_11")
print(sum(is.na(big_table_room_11)))
print("top of big_table_room_11")
print(head(big_table_room_11))
```

# Intra-Bird Analysis With All Rooms

```{r }
trans_reslist_room_2 <- list()

for(i in 1:length(reslist2_room_2)){
  
  daily_trans_table <- calc_trans_period(reslist2_room_2[[i]]$ID,reslist2_room_2[[i]]$daily_obj,reslist2_room_2[[i]]$xts_obj,"d", 0)
  weekly_trans_table <- calc_trans_period(reslist2_room_2[[i]]$ID,reslist2_room_2[[i]]$weekly_obj,reslist2_room_2[[i]]$xts_obj,"w", 0)
  monthly_trans_table <- calc_trans_period(reslist2_room_2[[i]]$ID,reslist2_room_2[[i]]$monthly_obj,reslist2_room_2[[i]]$xts_obj,"m",0)
    
  result <- list("ID"=reslist2_room_2[[i]]$ID,"daily"=daily_trans_table, "weekly"=weekly_trans_table,"monthly"=monthly_trans_table, "raw"=reslist2_room_2[[i]]$xts_obj)
  trans_reslist_room_2[[i]] <- result
}

room_2_daily <- data.frame()
room_2_weekly <- data.frame()
room_2_monthly <- data.frame()
#TODO select sample as opposed to ID for intra bird comparison (alpha eq)
for(item in trans_reslist_room_2){
  room_2_daily <- rbind(room_2_daily, item$daily[c("sample","bottom","mid","top","total")])
  room_2_weekly <- rbind(room_2_weekly, item$weekly[c("sample","bottom","mid","top","total")])
  room_2_monthly <- rbind(room_2_monthly, item$monthly[c("sample","bottom","mid","top","total")])
}

# check to make sure only one bird is selected
print("check that the id and RFID tag are unique for each item entry")
#this is following up with the issues of the intra-bird comparisons
for(item in trans_reslist_room_2){
  print(paste(unique(item$raw$Tagnumber)," ",unique(item$raw$tagname)))
  #print(item)
}

trans_reslist_room_3 <- list()
for(i in 1:length(reslist2_room_3)){
  
  daily_trans_table <- calc_trans_period(reslist2_room_3[[i]]$ID,reslist2_room_3[[i]]$daily_obj,reslist2_room_3[[i]]$xts_obj,"d",0)
  weekly_trans_table <- calc_trans_period(reslist2_room_3[[i]]$ID,reslist2_room_3[[i]]$weekly_obj,reslist2_room_3[[i]]$xts_obj,"w",0)
  monthly_trans_table <- calc_trans_period(reslist2_room_3[[i]]$ID,reslist2_room_3[[i]]$monthly_obj,reslist2_room_3[[i]]$xts_obj,"m",0)
    
  result <- list("ID"=reslist2_room_3[[i]]$ID,"daily"=daily_trans_table, "weekly"=weekly_trans_table,"monthly"=monthly_trans_table, "raw"=reslist2_room_3[[i]]$xts_obj)
  trans_reslist_room_3[[i]] <- result
}

room_3_daily <- data.frame()
room_3_weekly <- data.frame()
room_3_monthly <- data.frame()
#TODO select sample as opposed to ID for intra bird comparison (alpha eq)
for(item in trans_reslist_room_3){
  room_3_daily <- rbind(room_3_daily, item$daily[c("sample","bottom","mid","top","total")])
  room_3_weekly <- rbind(room_3_weekly, item$weekly[c("sample","bottom","mid","top","total")])
  room_3_monthly <- rbind(room_3_monthly, item$monthly[c("sample","bottom","mid","top","total")])
}

# check to make sure only one bird is selected
print("check that the id and RFID tag are unique for each item entry")
#this is following up with the issues of the intra-bird comparisons
for(item in trans_reslist_room_3){
  print(paste(unique(item$raw$Tagnumber)," ",unique(item$raw$tagname)))
  #print(item)
}

trans_reslist_room_8 <- list()

for(i in 1:length(reslist2_room_8)){
  
  daily_trans_table <- calc_trans_period(reslist2_room_8[[i]]$ID,reslist2_room_8[[i]]$daily_obj,reslist2_room_8[[i]]$xts_obj,"d",0)
  weekly_trans_table <- calc_trans_period(reslist2_room_8[[i]]$ID,reslist2_room_8[[i]]$weekly_obj,reslist2_room_8[[i]]$xts_obj,"w",0)
  monthly_trans_table <- calc_trans_period(reslist2_room_8[[i]]$ID,reslist2_room_8[[i]]$monthly_obj,reslist2_room_8[[i]]$xts_obj,"m",0)
    
  result <- list("ID"=reslist2_room_8[[i]]$ID,"daily"=daily_trans_table, "weekly"=weekly_trans_table,"monthly"=monthly_trans_table, "raw"=reslist2_room_8[[i]]$xts_obj)
  trans_reslist_room_8[[i]] <- result
}

room_8_daily <- data.frame()
room_8_weekly <- data.frame()
room_8_monthly <- data.frame()
#TODO select sample as opposed to ID for intra bird comparison (alpha eq)
for(item in trans_reslist_room_8){
  room_8_daily <- rbind(room_8_daily, item$daily[c("sample","bottom","mid","top","total")])
  room_8_weekly <- rbind(room_8_weekly, item$weekly[c("sample","bottom","mid","top","total")])
  room_8_monthly <- rbind(room_8_monthly, item$monthly[c("sample","bottom","mid","top","total")])
}

# check to make sure only one bird is selected
print("check that the id and RFID tag are unique for each item entry")
#this is following up with the issues of the intra-bird comparisons
for(item in trans_reslist_room_8){
  print(paste(unique(item$raw$tagnumber)," ",unique(item$raw$tagname)))
  #print(item)
}

trans_reslist_room_11 <- list()

for(i in 1:length(reslist2_room_11)){
  
  daily_trans_table <- calc_trans_period(reslist2_room_11[[i]]$ID,reslist2_room_11[[i]]$daily_obj,reslist2_room_11[[i]]$xts_obj,"d")
  weekly_trans_table <- calc_trans_period(reslist2_room_11[[i]]$ID,reslist2_room_11[[i]]$weekly_obj,reslist2_room_11[[i]]$xts_obj,"w")
  monthly_trans_table <- calc_trans_period(reslist2_room_11[[i]]$ID,reslist2_room_11[[i]]$monthly_obj,reslist2_room_11[[i]]$xts_obj,"m")
    
  result <- list("ID"=reslist2_room_11[[i]]$ID,"daily"=daily_trans_table, "weekly"=weekly_trans_table,"monthly"=monthly_trans_table, "raw"=reslist2_room_11[[i]]$xts_obj)
  trans_reslist_room_11[[i]] <- result
}

room_11_daily <- data.frame()
room_11_weekly <- data.frame()
room_11_monthly <- data.frame()
#TODO select sample as opposed to ID for intra bird comparison (alpha eq)
for(item in trans_reslist_room_11){
  room_11_daily <- rbind(room_11_daily, item$daily[c("sample","bottom","mid","top","total")])
  room_11_weekly <- rbind(room_11_weekly, item$weekly[c("sample","bottom","mid","top","total")])
  room_11_monthly <- rbind(room_11_monthly, item$monthly[c("sample","bottom","mid","top","total")])
}

# check to make sure only one bird is selected
print("check that the id and RFID tag are unique for each item entry")
#this is following up with the issues of the intra-bird comparisons
for(item in trans_reslist_room_11){
  print(paste(unique(item$raw$tagnumber)," ",unique(item$raw$tagname)))
  #print(item)
}

# w <- 0
# for(item in trans_reslist_room_2){
#   w <- w +1
#   print(w)
# }
# w <- 0
# for(item in trans_reslist_room_3){
#   w <- w +1
#   print(w)
# }
# w <- 0
# for(item in trans_reslist_room_8){
#   w <- w +1
#   print(w)
# }
# w <- 0
# for(item in trans_reslist_room_11){
#   w <- w +1
#   print(w)
# }
#write.csv(room_2_daily,"room_2_daily_intra.csv",row.names = F)
#write.csv(room_2_weekly,"room_2_weekly_intra.csv",row.names = F)
#write.csv(room_2_monthly,"room_2_monthly_intra.csv",row.names = F)

```